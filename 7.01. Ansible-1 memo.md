1. Устанавливаем Ansible на Ubuntu:
```
sudo apt-add-repository -y ppa:ansible/ansible && \
sudo apt update && \
sudo apt install -y ansible
```

2. Создаем каталог `~/ansible/` и инвентарный файл `hosts` в нем:

`mkdir ~/ansible && touch ~/ansible/hosts`

3. Генерим дефолтный конфиг:
```
sudo mv /etc/ansible/ansible.cfg /etc/ansible/ansible.cfg.bak && \
ansible-config init --disabled all > ~/ansible.cfg && \
sudo mv ~/ansible.cfg /etc/ansible/ansible.cfg
```

4. Меняем меняем формат вывода логов ansible на yml и прописываем в конфиге /etc/ansible/ansible.cfg путь к hosts (чтобы -i не указывать каждый раз):
```
sudo sed -i 's+;stdout_callback=default+stdout_callback=yml+g' /etc/ansible/ansible.cfg && \
sudo sed -i 's+;inventory=/etc/ansible/hosts+inventory=~/ansible/hosts+g' /etc/ansible/ansible.cfg
```
Опционально:

'sudo sed -i 's+;home=~/.ansible+home=~/.ansible+g' /etc/ansible/ansible.cfg'

5. Модифицируем файл `~/ansible/hosts`

> **Note**
> IP адреса, имя пользователя и ssh-ключи на те, которые будут у хостов, на которых нужно запустить ansible.

> **Note**
> Команда для генерации ключей ssh: `ssh-keygen -t ed25519`

```
all:
  webservers:
    51.250.91.39:
      ansible_ssh_user: ubuntu
      ansible_ssh_private_key_file: ~/.ssh/id_ed25519
    84.201.132.79:
      ansible_ssh_user: ubuntu
      ansible_ssh_private_key_file: ~/.ssh/id_ed25519
```

6. Убеждаемся, что на целевых серверах публичные ключи для id_ed25519 лежат в /home/ubuntu/.ssh/
7. Запускаем ansible: `ansible webservers -m ping`
8. AD-hoc комманды:
    `ansible webservers -b -m ansible.builtin.apt -a "name=mc state=present"`
    `ansible webservers -m command -a "systemctl status cron"` (ssh, ufw, kmod)
    `ansible webservers -m command -a 'echo "I like Linux" > /tmp/netology.txt'`


В Ansible параметр "forks" отвечает за количество параллельных процессов, которые Ansible будет использовать при выполнении задач на удаленных хостах. Когда Ansible выполняет задачу на нескольких хостах одновременно, эта опция позволяет задать количество хостов, которые могут быть обработаны одновременно. Например, если значение "forks" равно 5, то Ansible будет выполнять задачи на 5 хостах одновременно. Значение по умолчанию для "forks" - это 5.

С другой стороны, параметр "serial" задает количество хостов, на которых Ansible будет выполнять задачи последовательно. Если значение "serial" равно 1, то Ansible будет выполнять задачи на каждом хосте последовательно, передвигаясь от одного хоста к другому, пока все задачи не будут выполнены на всех хостах. Если значение "serial" больше 1, то Ansible будет выполнять задачи на заданном количестве хостов одновременно, передвигаясь далее к следующей группе хостов.

Таким образом, основное отличие между параметрами "forks" и "serial" заключается в том, что "forks" управляет количеством параллельных процессов на каждом хосте, тогда как "serial" управляет количеством хостов, на которых выполняются задачи последовательно.
---
Параметр "forks" в Ansible определяет количество параллельных процессов, которые Ansible может использовать для выполнения задач на удаленных хостах. Значение "forks" определяет, сколько хостов может быть обработано одновременно. Это позволяет Ansible выполнять задачи быстрее.

Параметр "serial" в Ansible, с другой стороны, управляет тем, как много хостов могут быть обработаны одновременно. Значение "serial" задает количество хостов, на которых Ansible будет выполнять задачи последовательно. Например, если значение "serial" равно 1, то Ansible будет выполнять задачи на каждом хосте последовательно.

Итак, разница между параметрами "forks" и "serial" заключается в том, что "forks" управляет количеством параллельных процессов на каждом хосте, тогда как "serial" управляет количеством хостов, на которых выполняются задачи последовательно.