# 12.3. SQL. Часть 2 - Кулагин Игорь
## Задание 1
>Одним запросом получите информацию о магазине, в котором обслуживается более 300 покупателей, и выведите в результат следующую информацию:
>- фамилия и имя сотрудника из этого магазина;
>- город нахождения магазина;
>- количество пользователей, закреплённых в этом магазине.
```
SELECT 
	s.store_id,
	CONCAT(s.first_name, " ", s.last_name) AS Staff_name,
	c.city AS City_name,
	COUNT(c2.customer_id) as Customer_number
FROM
	staff AS s
	INNER JOIN store AS s2 ON s.store_id = s2.store_id
	INNER JOIN address AS a ON s2.address_id = a.address_id
	INNER JOIN city AS c ON a.city_id  = c.city_id
	INNER JOIN customer AS c2 ON c2.store_id = s.store_id
GROUP BY 
	s.store_id,
	CONCAT(s.first_name, " ", s.last_name),
	c.city
HAVING 
    COUNT(c2.customer_id) > 300;
    
```
## Задание 2
>Получите количество фильмов, продолжительность которых больше средней продолжительности всех фильмов.

```

```
## Задание 3
>Получите информацию, за какой месяц была получена наибольшая сумма платежей, и добавьте информацию по количеству аренд за этот месяц.
```

```